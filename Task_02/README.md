# Компоненты современной СУБД

## Проводим анализ возможных запросов\отчетов\поиска данных.
По таблице *play_cards* нужна будет выборка всех карт определенной фракции. Соответственно нужен индекс на поле fraction. Кардинальность будет не высокая.
По таблице *players_cards* необходимо выбирать все карты игрока, которые находятся в руке, в сбросе и в колоде. Здесь можно создать составной индекс 
(player_card_state,player_in_match)

## Схема данных 

![SmashUpDiagram_01](https://user-images.githubusercontent.com/95203401/168132776-27bec67b-f059-48e2-ba6d-f8c3345a15be.jpg)

## Описание объектов и полей 
В каждой таблице есть первичный ключ, это всегда поле **id**, поле автоинкрементное. При описание полей это поле не указываю.  
### play_cards
Это карты, из которых каждый игрок составляет себе колоду. Заполняется заранее и корректируется только по мере необходимости. 
Поля: 
+ **fraction** - фракция приспешника или действия, тип integer, размерность четыре байта, ключ на таблицу **fractions**; 
+ **name** - понятное человеку наименование карты на русском языке, тип varchar, длина 20;
+ **description** - описание карты, какими свойствами обладает, что делает при разыгрывании на поле и т.д. на русском языке, тип varchar, длина 200;
+ **action_type** - специальное действие при розыгрывании карты и т.д. на русском языке, тип integer, размерность четыре байта, ключ на таблицу **card_action_type**; 
+ **damage** - атака,  тип integer, размерность два байта;
+ **quantity_in_deck** - количество экземпляров карты в колоде игрока,  тип integer, размерность два байта;
+ **code** - уникальный в рамках таблицы код записи, тип varchar, длина 20;
+ **type_play_card** - тип карты, приспешник или действие, тип char, длина 1.

### bases
Справочник. Все базы, которые возможно разыграть на игровое поле.
Поля:
+ **code** - уникальный в рамках таблицы код записи, тип varchar, длина 20;
+ **name** - понятное человеку наименование действия на русском языке, тип varchar, длина 20;
+ **description** - описание базы, что делает при разыгрывании на поле, особые свойства и т.д. на русском языке, тип varchar, длина 200;
+ **lives** - жизни базы, тип integer, размерность два байта;
+ **first_place_award** - количество очков, получаемое игроком при захвате базы за первое место, тип integer, размерность два байта;
+ **second_place_award** - количество очков, получаемое игроком при захвате базы за второе место, тип integer, размерность два байта;
+ **third_place_award** - количество очков, получаемое игроком при захвате базы за третье место, тип integer, размерность два байта;

### fractions
Справочник. Фракции действий или приспешников. 
Поля:
+ **code** - уникальный в рамках таблицы код записи, тип varchar, длина 20;
+ **name** - понятное человеку наименование фракции на русском языке, тип varchar, длина 20;

### card_action_type
Справочник. Специальное действие при розыгрывании карт. 
+ **code** - уникальный в рамках таблицы код записи, тип varchar, длина 20;
+ **name** - понятное человеку наименование действия на русском языке, тип varchar, длина 20;

### player_card_state
Справочник. Состояние карты у игрока: в колоде, в сбросе, в руке, на базе.
Поля:
+ **code** - уникальный в рамках таблицы код записи, тип varchar, длина 20;
+ **name** - понятное человеку наименование фракции на русском языке, тип varchar, длина 20;

### turn_stage 
Справочник. Этапы хода игрока, описаные в пункте 9.
Поля: 
+ **code** - уникальный в рамках таблицы код записи, тип varchar, длина 20;
+ **name** - понятное человеку наименование фракции на русском языке, тип varchar, длина 20;

### match
Текущая игра.
Поля:
+ **begin_match** - начало игры, тип date;
+ **end_match** - окончание игры, тип data;
+ **count_players** - количество игроков, тип integer, размерность два байта;

### players 
Игроки. Предполагается, что нужно зарегистрироваться и далее использовать свои учетные данные.
Поля: 
+ **nickname** - пседвоним игрока, тип varchar, длина 20;
+ **email** - email игрока, тип varchar, длина 50;
+ **pass** - пароль игрока, тип varchar, длина 30;

### players_in_match
Игроки, участвующие в конкретном матче. 
Поля:
+ **match** - текущая игра, тип integer, размерность четыре байта, ключ на таблицу **match**; 
+ **player** - игрок, тип integer, размерность четыре байта, ключ на таблицу **players**; 
+ **num_in_match** - номер игрока в конкретном матче, тип integer, размерность два байта;
+ **points** - количество очков игрока в конкретном матче, обновляется по ходу игры, тип integer, размерность два байта;

### players_cards
Карты игрока в конкретном матче. 
Поля:
+ **player_in_match** - игрок, участвующий в конкретном матче, тип integer, размерность четыре байта, ключ на таблицу **players_in_match**;
+ **play_card** - игровая карта, тип integer, размерность четыре байта, ключ на таблицу **play_cards**;
+ **player_card_state** - состояние карты (в колоде, в сбросе и т.д.), по ходу игры обновляется, тип integer, размерность четыре байта, ключ на таблицу **player_card_state**;

### bases_in_playing_field
Базы на игровом поле. 
Поля:
+ **base** - база, тип integer, размерность четыре байта, ключ на таблицу **bases**;
+ **base_life** - текущие жизни базы, обновляется по ходу игры,  тип integer, размерность два байта;
+ **match** - текущая игра,  тип integer, размерность четыре байта,
+ **state_base** - текущее состояние базы, активна или уничтожена,  тип char, длина 1;


### cards_in_bases
Карты игроков на базе в текущей игре.
Поля:
+ **bases_in_playing_field** - база на игровом поле, тип integer, размерность четыре байта, ключ на таблицу **bases_in_playing_field**;
+ **players_cards** - карта игрока, тип integer, размерность четыре байта, ключ на таблицу **players_cards**;
+ **damage_card** - текущая атака карты, может обновляться по ходу игры, тип integer, размерность два байта;

### match_process
Процесс игры. Довольно примитивный лог.
Поля:
+ **players_in_match** - игрок, участвующий в конкретном матче, тип integer, размерность четыре байта, ключ на таблицу **players_in_match**;
+ **turn_stage** - этап ходя, тип integer, размерность четыре байта, ключ на таблицу **turn_stage**;
+ **start_stage** - начало этапа, тип date;
+ **end_stage** - окончание этапа, тип date;
+ **left_to_play_minions** - осталось сыграть приспешников, при изменении добавляется новая запись, тип integer, размерность два байта;
+ **left_to_play_actions** - осталось сыграть действий, при изменении добавляется новая запись, тип integer, размерность два байта;
+ **played_card** - сыгранная карта игрока, тип integer, размерность четыре байта, ключ на таблицу **players_cards**;
+ **captured_the_base** - захваченная база, тип integer, размерность четыре байта, ключ на таблицу **bases_in_playing_field**;
+ **got_points** - сколько очков заработал очков, тип integer, размерность два байта;

